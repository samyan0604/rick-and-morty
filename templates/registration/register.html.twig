{# Extend the base template #}
{% extends 'base.html.twig' %}

{# Set the page title (appears in browser tab) #}
{% block title %}Register - Rick and Morty Portal{% endblock %}

{# Add custom CSS for the registration page #}
{% block stylesheets %}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ asset('css/login.css') }}" rel="stylesheet">
    <style>
    .alert-success {
        background-color: #f0fff4 !important;
        color: #155724 !important;
        border: 1px solid #c3e6cb !important;
        border-left: 4px solid #28a745 !important;
        padding: 15px 20px !important;
        border-radius: 8px !important;
        margin-bottom: 20px !important;
        display: flex !important;
        align-items: center !important;
    }
    </style>
{% endblock %}


{# Main page content #}
{% block body %}
    <div class="login-container">
        <div class="login-header">
            <img src="{{ asset('images/portal.png') }}" class="logo" alt="Rick & Morty Portal">
            <h1>Rick & Morty Portal</h1>
            <p class="subtitle">Create your account to continue</p>
        </div>

        {# Display flash messages (success/error) #}
        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ type == 'error' ? 'error' : 'success' }}">
                    <span class="alert-icon">
                        {% if type == 'error' %}❌{% else %}✅{% endif %}
                    </span>
                    <span>{{ message }}</span>
                </div>
            {% endfor %}
        {% endfor %}
        
        {# Registration form using Symfony form functions #}
        {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
            
            {# Username field #}
            <div class="form-group">
                {{ form_label(form.username) }}
                <div class="input-wrapper">
                    {{ form_widget(form.username, {
                        'attr': {
                            'class': 'form-control',
                            'placeholder': 'Enter username'
                        }
                    }) }}
                    <i class="fas fa-user input-icon"></i>
                </div>
                {{ form_errors(form.username) }}
            </div>

            {# Password field #}
            <div class="form-group">
                {{ form_label(form.password) }}
                <div class="input-wrapper">
                    {{ form_widget(form.password, {
                        'attr': {
                            'class': 'form-control',
                            'placeholder': 'Enter password'
                        }
                    }) }}
                    <i class="fas fa-lock input-icon"></i>
                </div>
                {{ form_errors(form.password) }}
            </div>

            {# Confirm Password field #}
            <div class="form-group">
                {{ form_label(form.confirmPassword) }}
                <div class="input-wrapper">
                    {{ form_widget(form.confirmPassword, {
                        'attr': {
                            'class': 'form-control',
                            'placeholder': 'Re-enter your password'
                        }
                    }) }}
                    <i class="fas fa-lock input-icon"></i>
                </div>
                {{ form_errors(form.confirmPassword) }}
            </div>
            
            {# Submit button #}
            {{ form_widget(form.submit, {
                'attr': {
                    'class': 'btn btn-primary'
                }
            }) }}
            
        {{ form_end(form) }}

        <div class="signup-link">
            <p>Already have an account?</p>
            <a href="{{ path('app_login') }}">
                <i class="fas fa-sign-in-alt"></i>
                Sign in here
            </a>
        </div>
    </div>
{% endblock %}

{# Add JavaScript if needed #}
{% block javascripts %}
    {{ parent() }}
    <script>
        // Add any registration-specific JavaScript here
        // For example, real-time password validation
        
        document.addEventListener('DOMContentLoaded', function() {
            const passwordField = document.querySelector('input[name="registration_form[password]"]');
            const confirmField = document.querySelector('input[name="registration_form[confirmPassword]"]');
            
            if (confirmField) {
                confirmField.addEventListener('input', function() {
                    if (passwordField.value !== confirmField.value) {
                        confirmField.style.borderColor = '#dc3545';
                    } else {
                        confirmField.style.borderColor = '#28a745';
                    }
                });
            }
        });
    </script>
{% endblock %}